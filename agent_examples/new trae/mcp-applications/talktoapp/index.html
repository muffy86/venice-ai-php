<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TalkToApp - Revolutionary AI App Builder</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">

    <!-- Enhanced Module System -->
    <script src="modules/mcp-integration.js" defer></script>
    <script src="modules/ai-services.js" defer></script>
    <script src="modules/app-generator.js" defer></script>
    <script src="modules/persistence.js" defer></script>
    <script src="modules/multimodal-manager.js" defer></script>
    <script src="modules/ai-agent.js" defer></script>
    <script src="modules/openrouter-manager.js" defer></script>
    <script src="modules/elevenlabs-manager.js" defer></script>
    <script src="modules/computer-vision-manager.js" defer></script>
    <script src="modules/enhanced-browser-manager.js" defer></script>
    <script src="modules/terminal-manager.js" defer></script>
    <script src="modules/agentic-automation-core.js" defer></script>
    <script src="modules/digital-automation-manager.js" defer></script>

    <!-- Strategic Enhancement Modules -->
    <script src="modules/performance-monitor.js" defer></script>
    <script src="modules/advanced-chat.js" defer></script>
    <script src="modules/template-library.js" defer></script>
    <script src="modules/pwa-enhancement.js" defer></script>
    <script src="modules/user-auth.js" defer></script>
    <script src="modules/advanced-voice.js" defer></script>
    <script src="modules/export-sharing.js" defer></script>
    <script src="modules/testing-suite.js" defer></script>
    <script src="modules/deployment-pipeline.js" defer></script>
    <script src="modules/analytics-feedback.js" defer></script>

    <!-- Strategic Integration Coordinator -->
    <script src="modules/strategic-integration.js" defer></script>

    <!-- Advanced Frontend Enhancement Modules -->
    <script src="modules/advanced-ui-engine.js" defer></script>
    <script src="modules/developer-tools-suite.js" defer></script>
    <script src="modules/automation-scripts.js" defer></script>
    <script src="modules/modern-web-apis.js" defer></script>
    <script src="modules/performance-optimization.js" defer></script>
    <script src="modules/security-privacy-suite.js" defer></script>

    <!-- Behavioral Learning & Automation Modules -->
    <script src="modules/behavioral-learning-engine.js" defer></script>
    <script src="modules/predictive-automation-core.js" defer></script>
    <script src="modules/intelligent-dashboard.js" defer></script>
    <script src="modules/quick-start-guide.js" defer></script>
    <script src="modules/contextual-intelligence.js" defer></script>
    <script src="modules/smart-notifications.js" defer></script>
    <script src="modules/adaptive-ui-manager.js" defer></script>
    <script src="modules/ai-orchestration-engine.js" defer></script>
    <script src="modules/neural-automation-core.js" defer></script>
    <script src="modules/enterprise-integration-hub.js" defer></script>
    <script src="modules/quantum-ai-processor.js" defer></script>
    <script src="modules/edge-computing-manager.js" defer></script>
    <script src="modules/blockchain-automation-ledger.js" defer></script>
    <script src="modules/metaverse-automation-interface.js" defer></script>
    <script src="modules/ai-suggestion-engine.js" defer></script>
    <script src="modules/system-tester.js" defer></script>
    <script src="modules/debug-console.js" defer></script>
    <script src="modules/auto-test-runner.js" defer></script>

    <!-- Dashboard Styles -->
    <link rel="stylesheet" href="styles/dashboard.css">

    <!-- Advanced Development Scripts -->
    <script src="scripts/advanced-development-scripts.js" defer></script>
    <script src="scripts/script-manager.js" defer></script>

    <!-- Advanced Memory System -->
    <script src="modules/advanced-memory-system.js" defer></script>
    <script src="modules/memory-database.js" defer></script>
    <script src="modules/memory-assistant.js" defer></script>

    <!-- Web History Context Learning System -->
    <script src="modules/web-history-tracker.js" defer></script>
    <script src="modules/enhanced-knowledge-database.js" defer></script>
    <script src="modules/mcp-pipeline-manager.js" defer></script>
    <script src="modules/context-learning-engine.js" defer></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            --secondary-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --accent-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow-soft: 0 8px 32px rgba(31, 38, 135, 0.37);
            --shadow-strong: 0 20px 40px rgba(0, 0, 0, 0.3);
            --text-primary: #2d3748;
            --text-secondary: #4a5568;
            --text-accent: #667eea;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(45deg, #667eea, #764ba2, #f093fb, #4facfe, #00f2fe);
            background-size: 400% 400%;
            animation: megaGradientShift 15s ease infinite;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            cursor: none;
        }

        /* Custom Cursor */
        .cursor {
            position: fixed;
            width: 20px;
            height: 20px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 50%;
            pointer-events: none;
            z-index: 10000;
            mix-blend-mode: difference;
            transition: transform 0.1s ease;
        }

        .cursor-follower {
            position: fixed;
            width: 8px;
            height: 8px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            transition: all 0.3s cubic-bezier(0.75, -0.27, 0.35, 1.25);
        }

        /* Floating Particles Background */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.6), rgba(118, 75, 162, 0.6));
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        @keyframes megaGradientShift {
            0% { background-position: 0% 50%; }
            25% { background-position: 100% 50%; }
            50% { background-position: 100% 100%; }
            75% { background-position: 0% 100%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            50% { transform: translateY(-100px) rotate(180deg); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(102, 126, 234, 0.5); }
            50% { box-shadow: 0 0 40px rgba(102, 126, 234, 0.8), 0 0 60px rgba(118, 75, 162, 0.6); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3) rotate(180deg);
            }
            50% {
                opacity: 1;
                transform: scale(1.05) rotate(10deg);
            }
            70% {
                transform: scale(0.9) rotate(-5deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .main-container {
            display: grid;
            grid-template-columns: 420px 1fr 420px;
            height: 100vh;
            gap: 25px;
            padding: 25px;
            position: relative;
            z-index: 10;
        }

        .glass-panel {
            background: var(--glass-bg);
            -webkit-backdrop-filter: blur(25px);
            backdrop-filter: blur(25px);
            border-radius: 30px;
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow-soft);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            animation: slideInUp 0.8s ease;
        }

        .glass-panel:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .glass-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                transparent,
                rgba(255, 255, 255, 0.2),
                transparent);
            transition: left 0.5s;
        }

        .glass-panel:hover::before {
            left: 100%;
        }

        .panel-header {
            padding: 30px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .panel-header::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary-gradient);
            animation: shimmer 2s infinite;
        }

        .panel-title {
            font-size: 2rem;
            font-weight: 800;
            background: var(--primary-gradient);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            animation: glow 3s ease-in-out infinite;
        }

        .panel-subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-weight: 500;
            opacity: 0.9;
        }

        .chat-messages {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
            scroll-behavior: smooth;
        }

        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: var(--primary-gradient);
            border-radius: 10px;
        }

        .message {
            padding: 20px 25px;
            border-radius: 25px;
            max-width: 90%;
            animation: bounceIn 0.6s ease;
            position: relative;
            overflow: hidden;
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .message:hover {
            transform: translateX(5px) scale(1.02);
        }

        .message.user {
            background: var(--primary-gradient);
            color: white;
            align-self: flex-end;
            margin-left: auto;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .message.ai {
            background: rgba(255, 255, 255, 0.95);
            color: var(--text-primary);
            align-self: flex-start;
            border: 1px solid rgba(102, 126, 234, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .message::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                transparent,
                rgba(255, 255, 255, 0.3),
                transparent);
            transition: left 0.6s;
        }

        .message:hover::before {
            left: 100%;
        }

        .input-container {
            padding: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .voice-input {
            display: flex;
            gap: 20px;
            align-items: center;
            margin-bottom: 20px;
        }

        .text-input {
            flex: 1;
            padding: 20px 25px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 30px;
            font-size: 1.1rem;
            background: rgba(255, 255, 255, 0.9);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            outline: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
        }

        .text-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15),
                        0 10px 30px rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
        }

        .voice-btn {
            width: 70px;
            height: 70px;
            border: none;
            border-radius: 50%;
            background: var(--primary-gradient);
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            position: relative;
            overflow: hidden;
        }

        .voice-btn:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.6);
        }

        .voice-btn:active {
            transform: scale(0.95);
        }

        .voice-btn.listening {
            animation: pulse 1.5s infinite, glow 2s infinite;
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .send-btn {
            padding: 15px 35px;
            background: var(--accent-gradient);
            color: white;
            border: none;
            border-radius: 25px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 30px rgba(250, 112, 154, 0.4);
            position: relative;
            overflow: hidden;
        }

        .send-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 40px rgba(250, 112, 154, 0.6);
        }

        .send-btn:active {
            transform: translateY(-1px) scale(1.02);
        }

        .app-preview {
            flex: 1;
            padding: 30px;
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.85));
            margin: 25px;
            border-radius: 25px;
            box-shadow:
                inset 0 0 30px rgba(0, 0, 0, 0.05),
                0 10px 30px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: auto;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .app-preview::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(circle at 30% 30%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 70% 70%, rgba(250, 112, 154, 0.1) 0%, transparent 50%);
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .app-preview:hover {
            background: linear-gradient(145deg, rgba(255, 255, 255, 1), rgba(255, 255, 255, 0.95));
            box-shadow:
                inset 0 0 40px rgba(102, 126, 234, 0.1),
                0 20px 50px rgba(0, 0, 0, 0.15);
            transform: scale(1.02);
        }

        .app-preview:hover::before {
            opacity: 1;
        }

        .preview-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--text-secondary);
            text-align: center;
            animation: breathe 4s ease-in-out infinite;
        }

        @keyframes breathe {
            0%, 100% { opacity: 0.7; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        .preview-placeholder .icon {
            font-size: 6rem;
            margin-bottom: 30px;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: float 6s ease-in-out infinite, iconGlow 3s ease-in-out infinite alternate;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        @keyframes iconGlow {
            0% { filter: drop-shadow(0 0 10px rgba(102, 126, 234, 0.3)); }
            100% { filter: drop-shadow(0 0 20px rgba(102, 126, 234, 0.6)); }
        }

        .templates-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            padding: 30px;
            overflow-y: auto;
            flex: 1;
        }

        .templates-grid::-webkit-scrollbar {
            width: 8px;
        }

        .templates-grid::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .templates-grid::-webkit-scrollbar-thumb {
            background: var(--primary-gradient);
            border-radius: 10px;
        }

        .template-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
            border-radius: 25px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
            -webkit-backdrop-filter: blur(15px);
            backdrop-filter: blur(15px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .template-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--primary-gradient);
            opacity: 0;
            transition: all 0.4s ease;
            z-index: -1;
        }

        .template-card::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transform: rotate(45deg);
            transition: all 0.6s ease;
            opacity: 0;
        }

        .template-card:hover {
            transform: translateY(-10px) scale(1.08) rotate(3deg);
            box-shadow:
                0 25px 50px rgba(102, 126, 234, 0.4),
                0 0 40px rgba(102, 126, 234, 0.2);
            border-color: rgba(255, 255, 255, 0.6);
            color: white;
        }

        .template-card:hover::before {
            opacity: 1;
        }

        .template-card:hover::after {
            opacity: 1;
            transform: rotate(45deg) translate(50%, 50%);
        }

        .template-card:hover .template-icon {
            transform: scale(1.3) rotate(15deg);
            filter: drop-shadow(0 8px 20px rgba(0, 0, 0, 0.4));
        }

        .template-card:hover .template-title,
        .template-card:hover .template-desc {
            color: white;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .template-icon {
            font-size: 3.5rem;
            margin-bottom: 20px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-block;
            background: var(--secondary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .template-title {
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 10px;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .template-desc {
            font-size: 0.95rem;
            color: var(--text-secondary);
            transition: all 0.3s ease;
            line-height: 1.4;
            transition: color 0.3s ease;
        }

        .template-card:hover .template-title,
        .template-card:hover .template-desc {
            color: white;
        }

        .quick-actions {
            padding: 25px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .action-btn {
            padding: 18px 25px;
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: 20px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 12px;
            justify-content: center;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }

        .action-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                transparent,
                rgba(255, 255, 255, 0.2),
                transparent);
            transition: left 0.5s;
        }

        .action-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .action-btn:hover::before {
            left: 100%;
        }

        .action-btn:active {
            transform: translateY(-1px) scale(1.01);
        }

        .achievement-notification {
            position: fixed;
            top: 30px;
            right: 30px;
            background: var(--accent-gradient);
            color: white;
            padding: 25px 30px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(250, 112, 154, 0.4);
            transform: translateX(400px) scale(0.8);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
            border: 1px solid rgba(255, 255, 255, 0.2);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
        }

        .achievement-notification.show {
            transform: translateX(0) scale(1);
            animation: bounceIn 0.6s ease;
        }

        .floating-helper {
            position: fixed;
            bottom: 35px;
            right: 35px;
            width: 80px;
            height: 80px;
            background: var(--secondary-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            cursor: pointer;
            box-shadow: 0 15px 35px rgba(79, 172, 254, 0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1500;
            animation: float 4s ease-in-out infinite;
        }

        .floating-helper:hover {
            transform: scale(1.15) rotate(10deg);
            box-shadow: 0 20px 50px rgba(79, 172, 254, 0.6);
        }

        .magic-wand {
            position: absolute;
            top: 25px;
            right: 25px;
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 30px rgba(155, 89, 182, 0.4);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .magic-wand:hover {
            transform: scale(1.1) rotate(20deg);
            box-shadow: 0 15px 40px rgba(155, 89, 182, 0.6);
            animation: glow 1s ease-in-out infinite;
        }

        /* Generated App Styles */
        .generated-app {
            width: 100%;
            height: 100%;
            border-radius: 15px;
            overflow: hidden;
            animation: slideInUp 0.8s ease;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .app-header {
            background: var(--primary-gradient);
            color: white;
            padding: 25px;
            text-align: center;
            font-size: 1.6rem;
            font-weight: 700;
            position: relative;
            overflow: hidden;
        }

        .app-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                transparent,
                rgba(255, 255, 255, 0.2),
                transparent);
            animation: shimmer 3s infinite;
        }

        .app-content {
            padding: 25px;
            background: rgba(255, 255, 255, 0.95);
        }

        .app-button {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 8px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }

        .app-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                transparent,
                rgba(255, 255, 255, 0.3),
                transparent);
            transition: left 0.5s;
        }

        .app-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .app-button:hover::before {
            left: 100%;
        }

        .app-button:active {
            transform: translateY(-1px) scale(1.02);
        }

        .app-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid rgba(102, 126, 234, 0.2);
            border-radius: 15px;
            font-size: 1rem;
            margin: 10px 0;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
            -webkit-backdrop-filter: blur(5px);
            backdrop-filter: blur(5px);
        }

        .app-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            outline: none;
            transform: translateY(-1px);
        }

        .app-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #667eea;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            -webkit-backdrop-filter: blur(5px);
            backdrop-filter: blur(5px);
        }

        .app-card:hover {
            transform: translateY(-2px) scale(1.01);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.12);
            border-left-color: #764ba2;
        }

        /* Enhanced Responsive Design */
        @media (max-width: 1400px) {
            .main-container {
                grid-template-columns: 380px 1fr 380px;
                gap: 20px;
                padding: 20px;
            }
        }

        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto;
                height: auto;
                min-height: 100vh;
                gap: 20px;
            }

            .glass-panel {
                min-height: 500px;
            }

            .templates-grid {
                grid-template-columns: 1fr 1fr 1fr;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 15px;
                gap: 15px;
            }

            .templates-grid {
                grid-template-columns: 1fr 1fr;
                gap: 15px;
                padding: 20px;
            }

            .voice-btn {
                width: 80px;
                height: 80px;
                font-size: 2rem;
            }

            .text-input {
                font-size: 1.2rem;
                padding: 20px 25px;
            }

            .floating-helper {
                width: 90px;
                height: 90px;
                font-size: 2.2rem;
                bottom: 20px;
                right: 20px;
            }

            .panel-title {
                font-size: 1.8rem;
            }

            .template-card {
                padding: 20px;
            }

            .achievement-notification {
                top: 20px;
                right: 20px;
                left: 20px;
                transform: translateY(-100px) scale(0.9);
            }

            .achievement-notification.show {
                transform: translateY(0) scale(1);
            }
        }

        /* Advanced hover effects */
        .hover-grow {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .hover-grow:hover {
            transform: scale(1.05) translateY(-2px);
        }

        .hover-glow:hover {
            animation: glow 1s ease-in-out infinite;
        }

        /* Loading animations */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Typing indicator */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 15px 20px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--text-accent);
            animation: typingDot 1.4s ease-in-out infinite both;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        .typing-dot:nth-child(3) { animation-delay: 0s; }

        @keyframes typingDot {
            0%, 80%, 100% {
                transform: scale(0);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Modal styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--glass-bg);
            -webkit-backdrop-filter: blur(25px);
            backdrop-filter: blur(25px);
            border-radius: 30px;
            border: 1px solid var(--glass-border);
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            color: white;
            animation: bounceIn 0.6s ease;
        }

        .modal-title {
            font-size: 2rem;
            font-weight: 800;
            background: var(--primary-gradient);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
        }

        .modal-desc {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .modal-btn {
            background: var(--accent-gradient);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 10px;
        }

        .modal-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 10px 30px rgba(250, 112, 154, 0.4);
        }

        /* Success animations */
        .success-ping {
            animation: successPing 0.6s ease;
        }

        @keyframes successPing {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Error shake */
        .error-shake {
            animation: errorShake 0.6s ease;
        }

        @keyframes errorShake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        /* Web History & Context Learning Styles */
        .web-history-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 320px;
            background: rgba(255, 255, 255, 0.1);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 20px;
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .web-history-panel.active {
            transform: translateX(0);
        }

        .context-learning-indicator {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px 15px;
            border-radius: 25px;
            font-size: 12px;
            z-index: 1000;
            animation: pulse 2s infinite;
        }

        .mcp-pipeline-status {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 11px;
            z-index: 1000;
            max-width: 300px;
        }

        .knowledge-suggestions {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
        }

        .knowledge-suggestions.visible {
            transform: translateY(0);
        }

        .suggestion-item {
            padding: 8px 12px;
            margin: 5px 0;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            transition: transform 0.2s ease;
        }

        .suggestion-item:hover {
            transform: scale(1.02);
        }

        .context-stats {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .stat-item {
            flex: 1;
            text-align: center;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            font-size: 11px;
        }

        .api-key-manager {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 500px;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            z-index: 2000;
            display: none;
        }

        .api-key-manager.active {
            display: block;
        }

        .api-key-input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
        }

        .api-key-input:focus {
            border-color: #667eea;
            outline: none;
        }

        .pipeline-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .pipeline-card {
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .pipeline-card:hover {
            transform: translateY(-2px);
        }

        .pipeline-card.active {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
    </style>
</head>
<body>
    <!-- Custom Cursor -->
    <div class="cursor"></div>
    <div class="cursor-follower"></div>

    <!-- Floating Particles -->
    <div class="particles" id="particles"></div>

    <!-- Achievement Notification -->
    <div class="achievement-notification" id="achievement">
        <div class="achievement-icon">🎉</div>
        <div class="achievement-text">
            <strong>Achievement Unlocked!</strong><br>
            <span id="achievement-desc">First app created!</span>
        </div>
    </div>

    <!-- Floating Helper -->
    <div class="floating-helper" onclick="showTutorial()" title="Need help? Click for tutorial!">
        💡
    </div>

    <div class="main-container">
        <!-- Left Panel: Chat Interface -->
        <div class="glass-panel">
            <div class="panel-header">
                <h2 class="panel-title">🎤 Voice Chat</h2>
                <p class="panel-subtitle">Speak your app ideas naturally</p>
            </div>

            <div class="chat-messages" id="chatMessages">
                <div class="message ai">
                    <strong>AI Assistant:</strong> Hi! I'm your AI app builder. Tell me what kind of app you'd like to create. Try saying "I want a colorful calculator" or choose from the templates on the right! 🚀
                </div>
            </div>

            <div class="input-container">
                <div class="voice-input">
                    <input type="text" class="text-input" id="textInput" placeholder="Type your app idea or use voice..." />
                    <button class="voice-btn" id="voiceBtn" title="Click and speak your idea">🎤</button>
                </div>
                <button class="send-btn" onclick="sendMessage()">✨ Create App</button>
            </div>
        </div>

        <!-- Center Panel: App Preview -->
        <div class="glass-panel">
            <div class="panel-header">
                <h2 class="panel-title">📱 Live Preview</h2>
                <p class="panel-subtitle">Watch your app come to life</p>
                <button class="magic-wand" onclick="enhanceApp()" title="Enhance with AI magic!">✨</button>
            </div>

            <div class="app-preview" id="appPreview">
                <div class="preview-placeholder">
                    <div class="icon">🚀</div>
                    <h3>Your app will appear here</h3>
                    <p>Describe what you want to build and watch the magic happen!</p>
                </div>
            </div>
        </div>

        <!-- Right Panel: Templates -->
        <div class="glass-panel">
            <div class="panel-header">
                <h2 class="panel-title">⚡ Quick Templates</h2>
                <p class="panel-subtitle">Instant app creation</p>
            </div>

            <div class="templates-grid">
                <div class="template-card" onclick="createTemplate('calculator')">
                    <div class="template-icon">🧮</div>
                    <div class="template-title">Calculator</div>
                    <div class="template-desc">Colorful math helper</div>
                </div>

                <div class="template-card" onclick="createTemplate('todo')">
                    <div class="template-icon">📝</div>
                    <div class="template-title">To-Do List</div>
                    <div class="template-desc">Task organizer</div>
                </div>

                <div class="template-card" onclick="createTemplate('gallery')">
                    <div class="template-icon">🖼️</div>
                    <div class="template-title">Photo Gallery</div>
                    <div class="template-desc">Image showcase</div>
                </div>

                <div class="template-card" onclick="createTemplate('game')">
                    <div class="template-icon">🎮</div>
                    <div class="template-title">Fun Game</div>
                    <div class="template-desc">Interactive play</div>
                </div>

                <div class="template-card" onclick="createTemplate('quiz')">
                    <div class="template-icon">❓</div>
                    <div class="template-title">Quiz App</div>
                    <div class="template-desc">Learning tool</div>
                </div>

                <div class="template-card" onclick="createTemplate('research')">
                    <div class="template-icon">🔍</div>
                    <div class="template-title">Research Tool</div>
                    <div class="template-desc">Smart search</div>
                </div>

                <div class="template-card" onclick="createTemplate('weather')">
                    <div class="template-icon">🌤️</div>
                    <div class="template-title">Weather</div>
                    <div class="template-desc">Forecast center</div>
                </div>

                <div class="template-card" onclick="createTemplate('timer')">
                    <div class="template-icon">⏰</div>
                    <div class="template-title">Timer</div>
                    <div class="template-desc">Time management</div>
                </div>

                <div class="template-card" onclick="createTemplate('art')">
                    <div class="template-icon">🎨</div>
                    <div class="template-title">Art Studio</div>
                    <div class="template-desc">Digital canvas</div>
                </div>

                <div class="template-card" onclick="createTemplate('music')">
                    <div class="template-icon">🎵</div>
                    <div class="template-title">Music Studio</div>
                    <div class="template-desc">Melody maker</div>
                </div>

                <div class="template-card" onclick="createTemplate('news')">
                    <div class="template-icon">📰</div>
                    <div class="template-title">News Center</div>
                    <div class="template-desc">Information hub</div>
                </div>
            </div>

            <div class="quick-actions">
                <button class="action-btn" onclick="saveApp()">
                    💾 Save Current App
                </button>
                <button class="action-btn" onclick="shareApp()">
                    📤 Share Creation
                </button>
                <button class="action-btn" onclick="showTutorial()">
                    📚 Open Tutorial
                </button>
            </div>
        </div>
    </div>

    <!-- Tutorial Modal -->
    <div class="modal" id="tutorialModal">
        <div class="modal-content">
            <h3 class="modal-title">🚀 Welcome to TalkToApp!</h3>
            <p class="modal-desc">
                Create amazing apps just by talking! Click the microphone and say something like
                "I want a colorful calculator" or choose from our quick templates.
            </p>
            <button class="modal-btn" onclick="closeTutorial()">Let's Start Creating! 🎨</button>
        </div>
    </div>

    <script>
        // Enhanced TalkToApp functionality with AAA visuals
        let recognition;
        let isListening = false;
        let currentApp = null;
        let achievementCount = 0;

        // Custom cursor functionality
        function initCustomCursor() {
            const cursor = document.querySelector('.cursor');
            const follower = document.querySelector('.cursor-follower');

            document.addEventListener('mousemove', (e) => {
                cursor.style.left = e.clientX + 'px';
                cursor.style.top = e.clientY + 'px';

                setTimeout(() => {
                    follower.style.left = e.clientX + 'px';
                    follower.style.top = e.clientY + 'px';
                }, 100);
            });

            // Enhanced cursor interactions
            document.addEventListener('mousedown', () => {
                cursor.style.transform = 'scale(0.8)';
                follower.style.transform = 'scale(2)';
            });

            document.addEventListener('mouseup', () => {
                cursor.style.transform = 'scale(1)';
                follower.style.transform = 'scale(1)';
            });
        }

        // Floating particles system
        function createParticles() {
            const particles = document.getElementById('particles');

            setInterval(() => {
                if (particles.children.length < 15) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = Math.random() * 100 + 'vw';
                    particle.style.width = particle.style.height = Math.random() * 10 + 5 + 'px';
                    particle.style.animationDuration = Math.random() * 3 + 3 + 's';
                    particle.style.opacity = Math.random() * 0.5 + 0.3;
                    particles.appendChild(particle);

                    setTimeout(() => {
                        if (particle.parentNode) {
                            particle.parentNode.removeChild(particle);
                        }
                    }, 6000);
                }
            }, 300);
        }

        // Voice recognition setup
        function initVoiceRecognition() {
            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'en-US';

                recognition.onstart = function() {
                    isListening = true;
                    document.getElementById('voiceBtn').classList.add('listening');
                    document.getElementById('voiceBtn').innerHTML = '🔴';
                    addMessage('ai', 'I\'m listening... Speak your app idea! 👂');
                };

                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript;
                    document.getElementById('textInput').value = transcript;
                    addMessage('user', transcript);
                    processVoiceInput(transcript);
                };

                recognition.onerror = function(event) {
                    console.error('Speech recognition error:', event.error);
                    addMessage('ai', 'Sorry, I couldn\'t hear you clearly. Try typing your idea instead! 😊');
                };

                recognition.onend = function() {
                    isListening = false;
                    document.getElementById('voiceBtn').classList.remove('listening');
                    document.getElementById('voiceBtn').innerHTML = '🎤';
                };

                document.getElementById('voiceBtn').addEventListener('click', toggleVoiceRecognition);
            } else {
                document.getElementById('voiceBtn').style.display = 'none';
                addMessage('ai', 'Voice recognition not supported. Please type your ideas! ⌨️');
            }
        }

        function toggleVoiceRecognition() {
            if (isListening) {
                recognition.stop();
            } else {
                recognition.start();
            }
        }

        // Enhanced message system with animations
        function addMessage(sender, content) {
            const messagesContainer = document.getElementById('chatMessages');
            const message = document.createElement('div');
            message.className = `message ${sender}`;
            message.innerHTML = `<strong>${sender === 'user' ? 'You' : 'AI Assistant'}:</strong> ${content}`;

            messagesContainer.appendChild(message);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            // Add typing indicator for AI responses
            if (sender === 'ai') {
                const typingIndicator = document.createElement('div');
                typingIndicator.className = 'typing-indicator';
                typingIndicator.innerHTML = '<div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>';
                messagesContainer.appendChild(typingIndicator);

                setTimeout(() => {
                    messagesContainer.removeChild(typingIndicator);
                }, 1000);
            }
        }

        // Enhanced app creation with spectacular visuals
        function processVoiceInput(input) {
            const lowerInput = input.toLowerCase();

            // Enhanced keyword detection with more natural language
            if (lowerInput.includes('calculator') || lowerInput.includes('math') || lowerInput.includes('numbers')) {
                createTemplate('calculator');
            } else if (lowerInput.includes('todo') || lowerInput.includes('task') || lowerInput.includes('list')) {
                createTemplate('todo');
            } else if (lowerInput.includes('photo') || lowerInput.includes('gallery') || lowerInput.includes('picture')) {
                createTemplate('gallery');
            } else if (lowerInput.includes('game') || lowerInput.includes('play') || lowerInput.includes('fun')) {
                createTemplate('game');
            } else if (lowerInput.includes('quiz') || lowerInput.includes('question') || lowerInput.includes('test')) {
                createTemplate('quiz');
            } else if (lowerInput.includes('research') || lowerInput.includes('search') || lowerInput.includes('find')) {
                createTemplate('research');
            } else if (lowerInput.includes('weather') || lowerInput.includes('forecast') || lowerInput.includes('rain')) {
                createTemplate('weather');
            } else if (lowerInput.includes('timer') || lowerInput.includes('stopwatch') || lowerInput.includes('time')) {
                createTemplate('timer');
            } else if (lowerInput.includes('art') || lowerInput.includes('draw') || lowerInput.includes('paint')) {
                createTemplate('art');
            } else if (lowerInput.includes('music') || lowerInput.includes('piano') || lowerInput.includes('song')) {
                createTemplate('music');
            } else if (lowerInput.includes('news') || lowerInput.includes('information') || lowerInput.includes('updates')) {
                createTemplate('news');
            } else {
                // Enhanced AI response for unrecognized input
                addMessage('ai', `Interesting idea! I heard "${input}". Let me suggest some options based on what I understood. Try asking for a specific app type like "calculator", "game", or "art studio"! 🎨`);
                showSuggestions();
            }
        }

        // Spectacular app template creation
        function createTemplate(type) {
            const preview = document.getElementById('appPreview');
            preview.style.transform = 'scale(0.8)';
            preview.style.opacity = '0.5';

            setTimeout(() => {
                let appHTML = '';
                let appName = '';

                switch(type) {
                    case 'calculator':
                        appName = '🧮 Rainbow Calculator';
                        appHTML = createCalculatorApp();
                        break;
                    case 'todo':
                        appName = '📝 Smart To-Do List';
                        appHTML = createTodoApp();
                        break;
                    case 'gallery':
                        appName = '🖼️ Photo Gallery';
                        appHTML = createGalleryApp();
                        break;
                    case 'game':
                        appName = '🎮 Catch the Stars Game';
                        appHTML = createGameApp();
                        break;
                    case 'quiz':
                        appName = '❓ Knowledge Quiz';
                        appHTML = createQuizApp();
                        break;
                    case 'research':
                        appName = '🔍 Research Assistant';
                        appHTML = createResearchApp();
                        break;
                    case 'weather':
                        appName = '🌤️ Weather Station';
                        appHTML = createWeatherApp();
                        break;
                    case 'timer':
                        appName = '⏰ Super Timer';
                        appHTML = createTimerApp();
                        break;
                    case 'art':
                        appName = '🎨 Digital Art Studio';
                        appHTML = createArtApp();
                        break;
                    case 'music':
                        appName = '🎵 Music Studio';
                        appHTML = createMusicApp();
                        break;
                    case 'news':
                        appName = '📰 News Center';
                        appHTML = createNewsApp();
                        break;
                    default:
                        appName = '✨ Custom App';
                        appHTML = createDefaultApp();
                }

                preview.innerHTML = appHTML;
                currentApp = { type, name: appName };

                // Spectacular entrance animation
                preview.style.transform = 'scale(1.1)';
                preview.style.opacity = '1';
                setTimeout(() => {
                    preview.style.transform = 'scale(1)';
                }, 300);

                addMessage('ai', `✨ Amazing! I've created your ${appName}! Try interacting with it in the preview area. You can enhance it further with the magic wand! 🪄`);

                // Show achievement
                showAchievement(`${appName} Created!`, 'Your app is ready to use! 🎉');

                // Add sparkle effects
                createSparkles();

            }, 300);
        }

        // App creation functions with enhanced visuals
        function createCalculatorApp() {
            return `
                <div class="generated-app">
                    <div class="app-header">🧮 Rainbow Calculator</div>
                    <div class="app-content">
                        <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 20px; border-radius: 15px; font-size: 2rem; text-align: center; margin-bottom: 20px; min-height: 60px; display: flex; align-items: center; justify-content: center;" id="calc-display">0</div>

                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;">
                            <button class="app-button" onclick="clearCalc()" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">C</button>
                            <button class="app-button" onclick="calcInput('/')" style="background: linear-gradient(135deg, #f39c12, #e67e22);">÷</button>
                            <button class="app-button" onclick="calcInput('*')" style="background: linear-gradient(135deg, #f39c12, #e67e22);">×</button>
                            <button class="app-button" onclick="calcInput('-')" style="background: linear-gradient(135deg, #f39c12, #e67e22);">−</button>

                            <button class="app-button" onclick="calcInput('7')" style="background: linear-gradient(135deg, #3498db, #2980b9);">7</button>
                            <button class="app-button" onclick="calcInput('8')" style="background: linear-gradient(135deg, #3498db, #2980b9);">8</button>
                            <button class="app-button" onclick="calcInput('9')" style="background: linear-gradient(135deg, #3498db, #2980b9);">9</button>
                            <button class="app-button" onclick="calcInput('+')" style="background: linear-gradient(135deg, #f39c12, #e67e22); grid-row: span 2;">+</button>

                            <button class="app-button" onclick="calcInput('4')" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">4</button>
                            <button class="app-button" onclick="calcInput('5')" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">5</button>
                            <button class="app-button" onclick="calcInput('6')" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">6</button>

                            <button class="app-button" onclick="calcInput('1')" style="background: linear-gradient(135deg, #1abc9c, #16a085);">1</button>
                            <button class="app-button" onclick="calcInput('2')" style="background: linear-gradient(135deg, #1abc9c, #16a085);">2</button>
                            <button class="app-button" onclick="calcInput('3')" style="background: linear-gradient(135deg, #1abc9c, #16a085);">3</button>
                            <button class="app-button" onclick="calculate()" style="background: linear-gradient(135deg, #27ae60, #229954); grid-row: span 2;">=</button>

                            <button class="app-button" onclick="calcInput('0')" style="background: linear-gradient(135deg, #34495e, #2c3e50); grid-column: span 2;">0</button>
                            <button class="app-button" onclick="calcInput('.')" style="background: linear-gradient(135deg, #34495e, #2c3e50);">.</button>
                        </div>
                    </div>
                </div>

                <script>
                    let calcExpression = '';
                    let calcDisplay = document.getElementById('calc-display');

                    function calcInput(value) {
                        if (calcDisplay.textContent === '0' && value !== '.') {
                            calcExpression = value;
                        } else {
                            calcExpression += value;
                        }
                        calcDisplay.textContent = calcExpression || '0';
                        calcDisplay.style.animation = 'none';
                        setTimeout(() => calcDisplay.style.animation = 'pulse 0.3s ease', 10);
                    }

                    function clearCalc() {
                        calcExpression = '';
                        calcDisplay.textContent = '0';
                        calcDisplay.style.animation = 'errorShake 0.5s ease';
                    }

                    function calculate() {
                        try {
                            let result = eval(calcExpression.replace('×', '*').replace('÷', '/').replace('−', '-'));
                            calcDisplay.textContent = result;
                            calcExpression = result.toString();
                            calcDisplay.style.animation = 'successPing 0.6s ease';
                        } catch(e) {
                            calcDisplay.textContent = 'Error';
                            calcDisplay.style.animation = 'errorShake 0.5s ease';
                            setTimeout(() => {
                                calcDisplay.textContent = '0';
                                calcExpression = '';
                            }, 1500);
                        }
                    }
                </script>
            `;
        }

        function createTodoApp() {
            return `
                <div class="generated-app">
                    <div class="app-header">📝 Smart To-Do List</div>
                    <div class="app-content">
                        <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                            <input type="text" id="todo-input" class="app-input" placeholder="Add a new task..." style="flex: 1;">
                            <button class="app-button" onclick="addTodo()" style="background: linear-gradient(135deg, #27ae60, #229954);">+ Add</button>
                        </div>

                        <div id="todo-list" style="max-height: 400px; overflow-y: auto;">
                            <div class="app-card" style="text-align: center; color: #6c757d;">
                                <div style="font-size: 3rem; margin-bottom: 15px;">✨</div>
                                <div>No tasks yet! Add your first task above.</div>
                            </div>
                        </div>

                        <div style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); border-radius: 15px; text-align: center;">
                            <strong>Tasks Completed: <span id="completed-count">0</span></strong>
                        </div>
                    </div>
                </div>

                <script>
                    let todos = [];
                    let completedCount = 0;

                    function addTodo() {
                        const input = document.getElementById('todo-input');
                        const text = input.value.trim();

                        if (text) {
                            const todo = {
                                id: Date.now(),
                                text: text,
                                completed: false
                            };

                            todos.push(todo);
                            input.value = '';
                            renderTodos();
                            input.style.animation = 'successPing 0.3s ease';
                        } else {
                            input.style.animation = 'errorShake 0.5s ease';
                        }
                    }

                    function toggleTodo(id) {
                        const todo = todos.find(t => t.id === id);
                        if (todo) {
                            todo.completed = !todo.completed;
                            if (todo.completed) {
                                completedCount++;
                            } else {
                                completedCount--;
                            }
                            renderTodos();
                            updateCompletedCount();
                        }
                    }

                    function deleteTodo(id) {
                        const todoIndex = todos.findIndex(t => t.id === id);
                        if (todoIndex > -1) {
                            if (todos[todoIndex].completed) {
                                completedCount--;
                            }
                            todos.splice(todoIndex, 1);
                            renderTodos();
                            updateCompletedCount();
                        }
                    }

                    function renderTodos() {
                        const list = document.getElementById('todo-list');

                        if (todos.length === 0) {
                            list.innerHTML = '<div class="app-card" style="text-align: center; color: #6c757d;">' +
                                '<div style="font-size: 3rem; margin-bottom: 15px;">✨</div>' +
                                '<div>No tasks yet! Add your first task above.</div>' +
                                '</div>';
                            return;
                        }

                        list.innerHTML = todos.map(todo =>
                            '<div class="app-card" style="display: flex; align-items: center; gap: 15px; ' + (todo.completed ? 'opacity: 0.7; text-decoration: line-through;' : '') + '">' +
                                '<input type="checkbox" ' + (todo.completed ? 'checked' : '') +
                                       ' onchange="toggleTodo(' + todo.id + ')"' +
                                       ' style="width: 20px; height: 20px; cursor: pointer;">' +
                                '<div style="flex: 1; font-size: 1.1rem;">' + todo.text + '</div>' +
                                '<button onclick="deleteTodo(' + todo.id + ')"' +
                                        ' style="background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; border: none; padding: 8px 12px; border-radius: 10px; cursor: pointer;">🗑️</button>' +
                            '</div>'
                        ).join('');
                    }

                    function updateCompletedCount() {
                        document.getElementById('completed-count').textContent = completedCount;
                    }

                    // Allow Enter key to add todos
                    document.getElementById('todo-input').addEventListener('keypress', function(e) {
                        if (e.key === 'Enter') {
                            addTodo();
                        }
                    });
                </script>
            `;
        }

        function createGameApp() {
            return `
                <div class="generated-app">
                    <div class="app-header">🎮 Catch the Stars Game</div>
                    <div class="app-content">
                        <div style="text-align: center; margin-bottom: 20px;">
                            <div style="font-size: 2rem; margin-bottom: 10px;">Score: <span id="game-score">0</span></div>
                            <button class="app-button" onclick="startGame()" id="start-btn">🎮 Start Game</button>
                        </div>

                        <div id="game-area" style="position: relative; width: 100%; height: 300px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 15px; overflow: hidden; display: none;">
                            <div id="player" style="position: absolute; bottom: 10px; left: 50%; width: 40px; height: 40px; background: #fff; border-radius: 50%; transform: translateX(-50%); transition: left 0.1s ease;">🚀</div>
                        </div>

                        <div id="game-over" style="display: none; text-align: center; padding: 20px;">
                            <div style="font-size: 2rem; margin-bottom: 15px;">🎉 Game Over!</div>
                            <div style="font-size: 1.3rem; margin-bottom: 20px;">Final Score: <span id="final-score">0</span></div>
                            <button class="app-button" onclick="resetGame()">🔄 Play Again</button>
                        </div>
                    </div>
                </div>

                <script>
                    let gameScore = 0;
                    let gameActive = false;
                    let stars = [];
                    let playerPos = 50;
                    let gameInterval;

                    function startGame() {
                        gameScore = 0;
                        gameActive = true;
                        stars = [];
                        playerPos = 50;

                        document.getElementById('game-area').style.display = 'block';
                        document.getElementById('start-btn').style.display = 'none';
                        document.getElementById('game-over').style.display = 'none';
                        document.getElementById('game-score').textContent = gameScore;

                        gameInterval = setInterval(gameLoop, 100);
                        document.addEventListener('keydown', movePlayer);
                    }

                    function gameLoop() {
                        // Create new stars
                        if (Math.random() < 0.1) {
                            createStar();
                        }

                        // Move stars down
                        moveStars();

                        // Check collisions
                        checkCollisions();

                        // Remove off-screen stars
                        removeOffScreenStars();
                    }

                    function createStar() {
                        const star = {
                            id: Date.now(),
                            x: Math.random() * 90,
                            y: 0,
                            element: null
                        };

                        const starElement = document.createElement('div');
                        starElement.id = 'star-' + star.id;
                        starElement.style.position = 'absolute';
                        starElement.style.left = star.x + '%';
                        starElement.style.top = star.y + 'px';
                        starElement.style.width = '20px';
                        starElement.style.height = '20px';
                        starElement.style.fontSize = '20px';
                        starElement.textContent = '⭐';

                        document.getElementById('game-area').appendChild(starElement);
                        star.element = starElement;
                        stars.push(star);
                    }

                    function moveStars() {
                        stars.forEach(star => {
                            star.y += 3;
                            star.element.style.top = star.y + 'px';
                        });
                    }

                    function movePlayer(e) {
                        if (!gameActive) return;

                        if (e.key === 'ArrowLeft' && playerPos > 5) {
                            playerPos -= 5;
                        } else if (e.key === 'ArrowRight' && playerPos < 95) {
                            playerPos += 5;
                        }

                        document.getElementById('player').style.left = playerPos + '%';
                    }

                    function checkCollisions() {
                        const player = document.getElementById('player');
                        const playerRect = player.getBoundingClientRect();

                        stars.forEach((star, index) => {
                            const starRect = star.element.getBoundingClientRect();

                            if (playerRect.left < starRect.right &&
                                playerRect.right > starRect.left &&
                                playerRect.top < starRect.bottom &&
                                playerRect.bottom > starRect.top) {

                                // Collision detected
                                gameScore += 10;
                                document.getElementById('game-score').textContent = gameScore;
                                star.element.remove();
                                stars.splice(index, 1);

                                // Visual feedback
                                player.style.animation = 'successPing 0.3s ease';
                                setTimeout(() => player.style.animation = '', 300);
                            }
                        });
                    }

                    function removeOffScreenStars() {
                        stars = stars.filter(star => {
                            if (star.y > 300) {
                                star.element.remove();
                                return false;
                            }
                            return true;
                        });

                        // End game if too many stars missed
                        if (stars.length > 10) {
                            endGame();
                        }
                    }

                    function endGame() {
                        gameActive = false;
                        clearInterval(gameInterval);
                        document.removeEventListener('keydown', movePlayer);

                        document.getElementById('final-score').textContent = gameScore;
                        document.getElementById('game-over').style.display = 'block';
                        document.getElementById('game-area').style.display = 'none';

                        // Clear remaining stars
                        stars.forEach(star => star.element.remove());
                        stars = [];
                    }

                    function resetGame() {
                        document.getElementById('start-btn').style.display = 'inline-block';
                        document.getElementById('game-over').style.display = 'none';
                    }
                </script>
            `;
        }

        // Additional app creation functions
        function createGalleryApp() {
            return `
                <div class="generated-app">
                    <div class="app-header">🖼️ Photo Gallery</div>
                    <div class="app-content">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                            <div class="app-card hover-grow" style="text-align: center; padding: 30px; background: linear-gradient(135deg, #ff7eb3, #ff758c);">
                                <div style="font-size: 4rem; margin-bottom: 15px;">🌅</div>
                                <div style="font-weight: 600; color: white;">Sunrise</div>
                            </div>
                            <div class="app-card hover-grow" style="text-align: center; padding: 30px; background: linear-gradient(135deg, #4facfe, #00f2fe);">
                                <div style="font-size: 4rem; margin-bottom: 15px;">🏔️</div>
                                <div style="font-weight: 600; color: white;">Mountains</div>
                            </div>
                            <div class="app-card hover-grow" style="text-align: center; padding: 30px; background: linear-gradient(135deg, #43e97b, #38f9d7);">
                                <div style="font-size: 4rem; margin-bottom: 15px;">🌊</div>
                                <div style="font-weight: 600; color: white;">Ocean</div>
                            </div>
                            <div class="app-card hover-grow" style="text-align: center; padding: 30px; background: linear-gradient(135deg, #fa709a, #fee140);">
                                <div style="font-size: 4rem; margin-bottom: 15px;">🌸</div>
                                <div style="font-weight: 600; color: white;">Flowers</div>
                            </div>
                        </div>
                        <div style="margin-top: 20px; text-align: center;">
                            <button class="app-button">📸 Add Photo</button>
                            <button class="app-button">🎨 Edit Gallery</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function createQuizApp() {
            return `
                <div class="generated-app">
                    <div class="app-header">❓ Knowledge Quiz</div>
                    <div class="app-content">
                        <div style="text-align: center; padding: 20px;">
                            <div style="font-size: 1.5rem; margin-bottom: 20px;">Question 1 of 3</div>
                            <div style="font-size: 1.2rem; margin-bottom: 30px; padding: 20px; background: rgba(102, 126, 234, 0.1); border-radius: 15px;">
                                What is the capital of France?
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 15px; margin-bottom: 20px;">
                                <button class="app-button" style="background: linear-gradient(135deg, #3498db, #2980b9);">Paris</button>
                                <button class="app-button" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">London</button>
                                <button class="app-button" style="background: linear-gradient(135deg, #f39c12, #e67e22);">Berlin</button>
                                <button class="app-button" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">Madrid</button>
                            </div>
                            <div style="font-size: 1.1rem; color: #27ae60;">Score: 0/3</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function createResearchApp() {
            return `
                <div class="generated-app">
                    <div class="app-header">🔍 Research Assistant</div>
                    <div class="app-content">
                        <div style="margin-bottom: 20px;">
                            <input type="text" class="app-input" placeholder="Enter your research topic..." style="width: 100%; margin-bottom: 15px;">
                            <button class="app-button" style="background: linear-gradient(135deg, #27ae60, #229954);">🔍 Search</button>
                        </div>
                        <div style="background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 15px;">
                            <h4>Research Results:</h4>
                            <div style="margin-top: 15px;">
                                <div class="app-card">
                                    <strong>📚 Academic Source</strong><br>
                                    Research findings on your topic...
                                </div>
                                <div class="app-card">
                                    <strong>🌐 Web Article</strong><br>
                                    Latest information and updates...
                                </div>
                                <div class="app-card">
                                    <strong>📊 Statistics</strong><br>
                                    Data and numerical insights...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function createWeatherApp() {
            return `
                <div class="generated-app">
                    <div class="app-header">🌤️ Weather Station</div>
                    <div class="app-content">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <div style="font-size: 4rem; margin-bottom: 15px;">☀️</div>
                            <div style="font-size: 2.5rem; font-weight: bold; color: #f39c12; margin-bottom: 10px;">72°F</div>
                            <div style="font-size: 1.3rem; color: #3498db; margin-bottom: 20px;">Sunny</div>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 15px;">
                            <div class="app-card" style="text-align: center; padding: 15px;">
                                <div style="font-size: 1.5rem;">🌡️</div>
                                <div>Feels like</div>
                                <div style="font-weight: bold;">75°F</div>
                            </div>
                            <div class="app-card" style="text-align: center; padding: 15px;">
                                <div style="font-size: 1.5rem;">💧</div>
                                <div>Humidity</div>
                                <div style="font-weight: bold;">45%</div>
                            </div>
                            <div class="app-card" style="text-align: center; padding: 15px;">
                                <div style="font-size: 1.5rem;">💨</div>
                                <div>Wind</div>
                                <div style="font-weight: bold;">8 mph</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function createTimerApp() {
            return `
                <div class="generated-app">
                    <div class="app-header">⏰ Super Timer</div>
                    <div class="app-content">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <div style="font-size: 4rem; font-weight: bold; color: #667eea; margin-bottom: 20px;" id="timer-display">00:00</div>
                            <div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 20px;">
                                <button class="app-button" onclick="startTimer()" style="background: linear-gradient(135deg, #27ae60, #229954);">▶️ Start</button>
                                <button class="app-button" onclick="pauseTimer()" style="background: linear-gradient(135deg, #f39c12, #e67e22);">⏸️ Pause</button>
                                <button class="app-button" onclick="resetTimer()" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">🔄 Reset</button>
                            </div>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                            <button class="app-button" onclick="setTimer(300)">5 min</button>
                            <button class="app-button" onclick="setTimer(600)">10 min</button>
                            <button class="app-button" onclick="setTimer(1500)">25 min</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function createArtApp() {
            return `
                <div class="generated-app">
                    <div class="app-header">🎨 Digital Art Studio</div>
                    <div class="app-content">
                        <div style="margin-bottom: 20px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap;">
                                <button class="app-button" style="background: #e74c3c;">🔴</button>
                                <button class="app-button" style="background: #f39c12;">🟡</button>
                                <button class="app-button" style="background: #27ae60;">🟢</button>
                                <button class="app-button" style="background: #3498db;">🔵</button>
                                <button class="app-button" style="background: #9b59b6;">🟣</button>
                                <button class="app-button" style="background: #34495e;">⚫</button>
                            </div>
                        </div>
                        <div style="width: 100%; height: 300px; background: white; border: 3px solid #667eea; border-radius: 15px; position: relative; overflow: hidden;">
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: #999;">
                                <div style="font-size: 3rem; margin-bottom: 15px;">🎨</div>
                                <div>Canvas ready for your creativity!</div>
                            </div>
                        </div>
                        <div style="margin-top: 15px; text-align: center;">
                            <button class="app-button">🖌️ Brush</button>
                            <button class="app-button">✏️ Pencil</button>
                            <button class="app-button">🗑️ Clear</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function createMusicApp() {
            return `
                <div class="generated-app">
                    <div class="app-header">🎵 Music Studio</div>
                    <div class="app-content">
                        <div style="margin-bottom: 20px;">
                            <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; margin-bottom: 20px;">
                                <button class="app-button" style="background: linear-gradient(135deg, #fff, #f8f9fa); color: #333; padding: 30px 10px;">C</button>
                                <button class="app-button" style="background: linear-gradient(135deg, #fff, #f8f9fa); color: #333; padding: 30px 10px;">D</button>
                                <button class="app-button" style="background: linear-gradient(135deg, #fff, #f8f9fa); color: #333; padding: 30px 10px;">E</button>
                                <button class="app-button" style="background: linear-gradient(135deg, #fff, #f8f9fa); color: #333; padding: 30px 10px;">F</button>
                                <button class="app-button" style="background: linear-gradient(135deg, #fff, #f8f9fa); color: #333; padding: 30px 10px;">G</button>
                                <button class="app-button" style="background: linear-gradient(135deg, #fff, #f8f9fa); color: #333; padding: 30px 10px;">A</button>
                                <button class="app-button" style="background: linear-gradient(135deg, #fff, #f8f9fa); color: #333; padding: 30px 10px;">B</button>
                            </div>
                        </div>
                        <div style="text-align: center;">
                            <button class="app-button" style="background: linear-gradient(135deg, #27ae60, #229954);">🎵 Play Melody</button>
                            <button class="app-button" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">⏹️ Stop</button>
                            <button class="app-button" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">💾 Save Song</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function createNewsApp() {
            return `
                <div class="generated-app">
                    <div class="app-header">📰 News Center</div>
                    <div class="app-content">
                        <div style="margin-bottom: 20px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                                <button class="app-button" style="background: linear-gradient(135deg, #3498db, #2980b9);">🌍 World</button>
                                <button class="app-button" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">🏈 Sports</button>
                                <button class="app-button" style="background: linear-gradient(135deg, #f39c12, #e67e22);">💼 Business</button>
                                <button class="app-button" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">🔬 Science</button>
                            </div>
                        </div>
                        <div>
                            <div class="app-card">
                                <strong>🌍 Breaking News</strong><br>
                                <span style="color: #666;">Latest developments in world events...</span>
                            </div>
                            <div class="app-card">
                                <strong>💼 Market Update</strong><br>
                                <span style="color: #666;">Financial markets show positive trends...</span>
                            </div>
                            <div class="app-card">
                                <strong>🔬 Science Discovery</strong><br>
                                <span style="color: #666;">Researchers make breakthrough in technology...</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function createDefaultApp() {
            return `
                <div class="generated-app">
                    <div class="app-header">✨ Custom App</div>
                    <div class="app-content">
                        <div style="text-align: center; padding: 40px;">
                            <div style="font-size: 5rem; margin-bottom: 20px;">🚀</div>
                            <h3>Your Custom App</h3>
                            <p>This is a template for your custom application. Describe what you want to build and I'll create it for you!</p>
                            <button class="app-button" style="margin-top: 20px;">🎨 Customize</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Enhanced utility functions
        function sendMessage() {
            const input = document.getElementById('textInput');
            const message = input.value.trim();

            if (message) {
                addMessage('user', message);
                processVoiceInput(message);
                input.value = '';
            }
        }

        function enhanceApp() {
            if (currentApp) {
                addMessage('ai', `🪄 Enhancing your ${currentApp.name} with AI magic! Adding beautiful animations, improved colors, and enhanced functionality...`);

                // Add visual enhancement effects
                const preview = document.getElementById('appPreview');
                preview.style.filter = 'brightness(1.2) saturate(1.3)';
                preview.style.animation = 'glow 2s ease-in-out infinite';

                setTimeout(() => {
                    preview.style.filter = '';
                    preview.style.animation = '';
                    addMessage('ai', '✨ Enhancement complete! Your app now has improved visuals and better user experience!');
                    showAchievement('App Enhanced!', 'Magic applied successfully! 🪄');
                }, 3000);
            } else {
                addMessage('ai', 'Create an app first, then I can enhance it with magical improvements! ✨');
            }
        }

        function showAchievement(title, description) {
            achievementCount++;
            const achievement = document.getElementById('achievement');
            const titleSpan = achievement.querySelector('strong');
            const descSpan = document.getElementById('achievement-desc');

            titleSpan.textContent = title;
            descSpan.textContent = description;

            achievement.classList.add('show');

            setTimeout(() => {
                achievement.classList.remove('show');
            }, 4000);
        }

        function createSparkles() {
            const preview = document.getElementById('appPreview');

            for (let i = 0; i < 8; i++) {
                setTimeout(() => {
                    const sparkle = document.createElement('div');
                    sparkle.style.position = 'absolute';
                    sparkle.style.width = '20px';
                    sparkle.style.height = '20px';
                    sparkle.style.background = 'linear-gradient(45deg, #FFD700, #FFA500)';
                    sparkle.style.borderRadius = '50%';
                    sparkle.style.left = Math.random() * 100 + '%';
                    sparkle.style.top = Math.random() * 100 + '%';
                    sparkle.style.animation = 'sparkle 1.5s ease-out forwards';
                    sparkle.style.pointerEvents = 'none';
                    sparkle.style.zIndex = '1000';

                    const keyframes = `
                        @keyframes sparkle {
                            0% { transform: scale(0) rotate(0deg); opacity: 1; }
                            50% { transform: scale(1.2) rotate(180deg); opacity: 0.8; }
                            100% { transform: scale(0) rotate(360deg); opacity: 0; }
                        }
                    `;

                    if (!document.querySelector('#sparkle-styles')) {
                        const style = document.createElement('style');
                        style.id = 'sparkle-styles';
                        style.textContent = keyframes;
                        document.head.appendChild(style);
                    }

                    preview.appendChild(sparkle);

                    setTimeout(() => {
                        if (sparkle.parentNode) {
                            sparkle.parentNode.removeChild(sparkle);
                        }
                    }, 1500);
                }, i * 200);
            }
        }

        function showSuggestions() {
            const suggestions = [
                { type: 'calculator', name: '🧮 Calculator', desc: 'For math and calculations' },
                { type: 'game', name: '🎮 Game', desc: 'Fun interactive entertainment' },
                { type: 'art', name: '🎨 Art Studio', desc: 'Digital drawing and creativity' },
                { type: 'music', name: '🎵 Music Studio', desc: 'Create melodies and songs' }
            ];

            addMessage('ai', 'Here are some popular app types you might enjoy:');

            suggestions.forEach(suggestion => {
                setTimeout(() => {
                    addMessage('ai', `${suggestion.name} - ${suggestion.desc}`);
                }, 500);
            });
        }

        function saveApp() {
            if (currentApp) {
                showAchievement('App Saved!', `${currentApp.name} saved to your collection! 💾`);
                addMessage('ai', `📁 ${currentApp.name} has been saved! You can access it anytime from your app collection.`);
            } else {
                addMessage('ai', 'Create an app first, then you can save it to your collection! 🎨');
            }
        }

        function shareApp() {
            if (currentApp) {
                showAchievement('Ready to Share!', `${currentApp.name} is ready to share! 📤`);
                addMessage('ai', `🌐 ${currentApp.name} is ready to share! You can send it to friends and family to show off your creation!`);
            } else {
                addMessage('ai', 'Create an app first, then you can share it with others! ✨');
            }
        }

        function showTutorial() {
            document.getElementById('tutorialModal').classList.add('show');
        }

        function closeTutorial() {
            document.getElementById('tutorialModal').classList.remove('show');
        }

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initCustomCursor();
            createParticles();
            initVoiceRecognition();

            // Add global error handler for module loading
            window.addEventListener('error', function(e) {
                if (e.filename && e.filename.includes('/modules/')) {
                    console.warn('⚠️ Module loading error:', e.filename, e.message);
                    // Continue execution instead of stopping
                    e.preventDefault();
                    return false;
                }
            });

            // Initialize advanced modules with comprehensive error handling
            try {
                // Initialize Advanced UI Engine
                try {
                    if (typeof AdvancedUIEngine !== 'undefined') {
                        window.advancedUIEngine = new AdvancedUIEngine();
                        console.log('✨ Advanced UI Engine initialized');
                    }
                } catch (error) {
                    console.warn('⚠️ Advanced UI Engine failed to initialize:', error.message);
                }

                // Initialize Developer Tools Suite
                if (typeof DeveloperToolsSuite !== 'undefined') {
                    window.developerTools = new DeveloperToolsSuite();
                    console.log('🛠️ Developer Tools Suite initialized');
                }

                // Initialize Automation Scripts
                if (typeof AutomationScripts !== 'undefined') {
                    window.automationScripts = new AutomationScripts();
                    console.log('🤖 Automation Scripts initialized');
                }

                // Initialize Modern Web APIs
                if (typeof ModernWebAPIs !== 'undefined') {
                    window.modernWebAPIs = new ModernWebAPIs();
                    console.log('🌐 Modern Web APIs initialized');
                }

                // Initialize Performance Optimization Engine
                if (typeof PerformanceOptimizationEngine !== 'undefined') {
                    window.performanceEngine = new PerformanceOptimizationEngine();
                    console.log('⚡ Performance Optimization Engine initialized');
                }

                // Initialize Security & Privacy Suite
                if (typeof SecurityPrivacySuite !== 'undefined') {
                    window.securitySuite = new SecurityPrivacySuite();
                    console.log('🔒 Security & Privacy Suite initialized');
                }

                // Initialize Script Manager
                if (typeof ScriptManager !== 'undefined') {
                    window.scriptManager = new ScriptManager();
                    console.log('📜 Script Manager initialized');
                }

                // Initialize Advanced Development Scripts
                if (typeof AdvancedDevelopmentScripts !== 'undefined') {
                    window.advancedDevScripts = new AdvancedDevelopmentScripts();
                    console.log('🚀 Advanced Development Scripts initialized');
                }

                // Initialize Advanced Memory System
                if (typeof AdvancedMemorySystem !== 'undefined') {
                    window.memorySystem = new AdvancedMemorySystem();
                    console.log('🧠 Advanced Memory System initialized');
                }

                // Initialize Memory Database
                if (typeof MemoryDatabase !== 'undefined') {
                    window.memoryDatabase = new MemoryDatabase();
                    console.log('💾 Memory Database initialized');
                }

                // Initialize Memory Assistant (will auto-initialize when dependencies are ready)
                console.log('🤖 Memory Assistant will initialize automatically');

                // Initialize Web History Context Learning System
                if (typeof WebHistoryTracker !== 'undefined') {
                    window.webHistoryTracker = new WebHistoryTracker();
                    console.log('📊 Web History Tracker initialized');
                }

                if (typeof EnhancedKnowledgeDatabase !== 'undefined') {
                    window.enhancedKnowledgeDatabase = new EnhancedKnowledgeDatabase();
                    console.log('🧠 Enhanced Knowledge Database initialized');
                }

                if (typeof MCPPipelineManager !== 'undefined') {
                    window.mcpPipelineManager = new MCPPipelineManager();
                    console.log('🔗 MCP Pipeline Manager initialized');
                }

                // Context Learning Engine will auto-initialize after other systems
                console.log('🧠 Context Learning Engine will initialize automatically');

                // Initialize Contextual Intelligence Systems
                if (typeof ContextualIntelligence !== 'undefined') {
                    window.contextualIntelligence = new ContextualIntelligence();
                    console.log('🧠 Contextual Intelligence initialized');
                }

                if (typeof SmartNotifications !== 'undefined') {
                    window.smartNotifications = new SmartNotifications();
                    console.log('🔔 Smart Notifications initialized');
                }

                if (typeof AdaptiveUIManager !== 'undefined') {
                    window.adaptiveUI = new AdaptiveUIManager();
                    console.log('🎨 Adaptive UI Manager initialized');
                }

                // Initialize Advanced AI Systems with error handling
                try {
                    if (typeof AIOrchestrationEngine !== 'undefined') {
                        window.aiOrchestration = new AIOrchestrationEngine();
                        console.log('🤖 AI Orchestration Engine initialized');
                    }
                } catch (error) {
                    console.warn('⚠️ AI Orchestration Engine failed to initialize:', error.message);
                }

                try {
                    if (typeof NeuralAutomationCore !== 'undefined') {
                        window.neuralAutomation = new NeuralAutomationCore();
                        console.log('🧠 Neural Automation Core initialized');
                    }
                } catch (error) {
                    console.warn('⚠️ Neural Automation Core failed to initialize:', error.message);
                }

                try {
                    if (typeof EnterpriseIntegrationHub !== 'undefined') {
                        window.enterpriseHub = new EnterpriseIntegrationHub();
                        console.log('🏢 Enterprise Integration Hub initialized');
                    }
                } catch (error) {
                    console.warn('⚠️ Enterprise Integration Hub failed to initialize:', error.message);
                }

                // Initialize Cutting-Edge Systems with error handling
                try {
                    if (typeof QuantumAIProcessor !== 'undefined') {
                        window.quantumAI = new QuantumAIProcessor();
                        console.log('⚛️ Quantum AI Processor initialized');
                    }
                } catch (error) {
                    console.warn('⚠️ Quantum AI Processor failed to initialize:', error.message);
                }

                try {
                    if (typeof EdgeComputingManager !== 'undefined') {
                        window.edgeComputing = new EdgeComputingManager();
                        console.log('🌐 Edge Computing Manager initialized');
                    }
                } catch (error) {
                    console.warn('⚠️ Edge Computing Manager failed to initialize:', error.message);
                }

                try {
                    if (typeof BlockchainAutomationLedger !== 'undefined') {
                        window.blockchainLedger = new BlockchainAutomationLedger();
                        console.log('🔗 Blockchain Automation Ledger initialized');
                    }
                } catch (error) {
                    console.warn('⚠️ Blockchain Automation Ledger failed to initialize:', error.message);
                }

                if (typeof MetaverseAutomationInterface !== 'undefined') {
                    window.metaverseInterface = new MetaverseAutomationInterface();
                    console.log('🌌 Metaverse Automation Interface initialized');
                }

                // Initialize AI Suggestion Engine
                if (typeof AISuggestionEngine !== 'undefined') {
                    window.aiSuggestions = new AISuggestionEngine();
                    console.log('🤖 AI Suggestion Engine initialized');
                }

                // Initialize System Tester
                if (typeof SystemTester !== 'undefined') {
                    window.systemTester = new SystemTester();
                    console.log('🧪 System Tester initialized');
                }

                console.log('🎉 All advanced modules initialized successfully!');
            } catch (error) {
                console.error('❌ Error initializing advanced modules:', error);
            }

            // Add text input functionality
            const textInput = document.getElementById('textInput');
            if (textInput) {
                textInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });
            }

            // Welcome message
            setTimeout(() => {
                addMessage('ai', '🎉 Welcome to TalkToApp! I\'m ready to help you create amazing applications with advanced features. What would you like to build today?');
            }, 1000);
        });
    </script>

    <!-- Web History & Context Learning UI Elements -->

    <!-- Context Learning Indicator -->
    <div class="context-learning-indicator" id="contextIndicator">
        🧠 Learning from your activity...
    </div>

    <!-- MCP Pipeline Status -->
    <div class="mcp-pipeline-status" id="mcpStatus">
        <div>🔗 MCP Pipelines: <span id="pipelineCount">0</span> active</div>
        <div>🔑 API Keys: <span id="apiKeyCount">0</span> configured</div>
        <div>📊 Requests: <span id="requestCount">0</span> today</div>
    </div>

    <!-- Web History Panel -->
    <div class="web-history-panel" id="webHistoryPanel">
        <h3>📊 Web Activity</h3>
        <div class="context-stats">
            <div class="stat-item">
                <div id="pagesVisited">0</div>
                <div>Pages</div>
            </div>
            <div class="stat-item">
                <div id="topicsLearned">0</div>
                <div>Topics</div>
            </div>
            <div class="stat-item">
                <div id="patternsFound">0</div>
                <div>Patterns</div>
            </div>
        </div>
        <div id="recentActivity"></div>
        <button onclick="toggleWebHistoryTracking()" id="trackingToggle">
            🔴 Start Tracking
        </button>
    </div>

    <!-- Knowledge Suggestions -->
    <div class="knowledge-suggestions" id="knowledgeSuggestions">
        <h4>💡 Smart Suggestions</h4>
        <div id="suggestionsList"></div>
    </div>

    <!-- API Key Manager Modal -->
    <div class="api-key-manager" id="apiKeyManager">
        <h3>🔑 API Key Management</h3>
        <p>Configure your API keys for enhanced functionality:</p>

        <div class="pipeline-grid" id="pipelineGrid">
            <!-- Pipeline cards will be dynamically generated -->
        </div>

        <div id="apiKeyInputs">
            <!-- API key inputs will be dynamically generated -->
        </div>

        <div style="text-align: center; margin-top: 20px;">
            <button onclick="saveAPIKeys()" style="background: #4CAF50; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; margin-right: 10px;">
                💾 Save Keys
            </button>
            <button onclick="closeAPIKeyManager()" style="background: #f44336; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">
                ❌ Close
            </button>
        </div>
    </div>

    <!-- Overlay for modals -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeAPIKeyManager()" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1999;"></div>

    <script>
        // Global functions for new features
        function toggleWebHistoryTracking() {
            const button = document.getElementById('trackingToggle');
            const panel = document.getElementById('webHistoryPanel');

            if (window.webHistoryTracker) {
                const isTracking = window.webHistoryTracker.toggleTracking();
                button.textContent = isTracking ? '🟢 Stop Tracking' : '🔴 Start Tracking';
                panel.classList.toggle('active', isTracking);
            }
        }

        function openAPIKeyManager() {
            document.getElementById('apiKeyManager').classList.add('active');
            document.getElementById('modalOverlay').style.display = 'block';

            if (window.mcpPipelineManager) {
                window.mcpPipelineManager.showUI();
            }
        }

        function closeAPIKeyManager() {
            document.getElementById('apiKeyManager').classList.remove('active');
            document.getElementById('modalOverlay').style.display = 'none';
        }

        function saveAPIKeys() {
            if (window.mcpPipelineManager) {
                window.mcpPipelineManager.saveAPIKeys();
                closeAPIKeyManager();
            }
        }

        // Add keyboard shortcut to open API key manager
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.shiftKey && e.key === 'K') {
                openAPIKeyManager();
            }
        });

        // Update status indicators periodically
        setInterval(function() {
            if (window.mcpPipelineManager) {
                const stats = window.mcpPipelineManager.getStats();
                document.getElementById('pipelineCount').textContent = stats.activePipelines;
                document.getElementById('apiKeyCount').textContent = stats.configuredKeys;
                document.getElementById('requestCount').textContent = stats.requestsToday;
            }

            if (window.webHistoryTracker) {
                const stats = window.webHistoryTracker.getStats();
                document.getElementById('pagesVisited').textContent = stats.pagesVisited;
                document.getElementById('topicsLearned').textContent = stats.topicsLearned;
                document.getElementById('patternsFound').textContent = stats.patternsFound;
            }
        }, 5000);
    </script>
</body>
</html>
