<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Monitoring Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .dashboard-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e9ecef;
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .status-online { background: #28a745; }
        .status-warning { background: #ffc107; }
        .status-offline { background: #dc3545; }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .metric-item {
            text-align: center;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .metric-value {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .metric-label {
            font-size: 0.9rem;
            color: #6c757d;
        }

        .uptime { color: #28a745; }
        .response-time { color: #17a2b8; }
        .requests { color: #6f42c1; }
        .errors { color: #dc3545; }

        .chart-container {
            height: 200px;
            background: #f8f9fa;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
            position: relative;
            overflow: hidden;
        }

        .chart-placeholder {
            text-align: center;
        }

        .server-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .server-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            transition: background-color 0.3s ease;
        }

        .server-item:hover {
            background: #f8f9fa;
        }

        .server-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .server-icon {
            font-size: 1.5rem;
        }

        .server-details h4 {
            margin-bottom: 0.25rem;
            color: #2c3e50;
        }

        .server-details p {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .server-metrics {
            text-align: right;
            font-size: 0.9rem;
        }

        .alert-list {
            max-height: 250px;
            overflow-y: auto;
        }

        .alert-item {
            padding: 1rem;
            border-left: 4px solid;
            margin-bottom: 0.5rem;
            border-radius: 0 8px 8px 0;
        }

        .alert-critical {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .alert-warning {
            border-color: #ffc107;
            background: #fff3cd;
        }

        .alert-info {
            border-color: #17a2b8;
            background: #d1ecf1;
        }

        .alert-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .alert-title {
            font-weight: 600;
        }

        .alert-time {
            font-size: 0.8rem;
            color: #6c757d;
        }

        .log-container {
            background: #2c3e50;
            color: #ecf0f1;
            border-radius: 8px;
            height: 250px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            padding: 1rem;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .log-entry {
            margin-bottom: 0.5rem;
            padding: 0.25rem 0;
        }

        .log-timestamp {
            color: #95a5a6;
        }

        .log-level-info { color: #3498db; }
        .log-level-success { color: #2ecc71; }
        .log-level-warning { color: #f39c12; }
        .log-level-error { color: #e74c3c; }

        .controls {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-warning {
            background: #ffc107;
            color: #212529;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .refresh-status {
            margin-left: auto;
            color: #6c757d;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .auto-refresh {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #667eea;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .performance-chart {
            height: 150px;
            background: linear-gradient(to right,
                rgba(102, 126, 234, 0.1) 0%,
                rgba(102, 126, 234, 0.3) 50%,
                rgba(102, 126, 234, 0.1) 100%);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }

        .chart-line {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60%;
            background: linear-gradient(45deg,
                transparent 45%,
                rgba(102, 126, 234, 0.6) 50%,
                transparent 55%);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        .system-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem;
            background: #f8f9fa;
            border-radius: 4px;
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .refresh-status {
                margin-left: 0;
                margin-top: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📊 MCP Monitoring Dashboard</h1>
            <p>Real-time monitoring and analytics for your MCP server infrastructure</p>
        </div>

        <div class="controls">
            <button class="btn btn-primary" onclick="refreshAll()">🔄 Refresh All</button>
            <button class="btn btn-success" onclick="exportReport()">📊 Export Report</button>
            <button class="btn btn-warning" onclick="clearAlerts()">🗑️ Clear Alerts</button>
            <button class="btn btn-danger" onclick="emergencyStop()">🛑 Emergency Stop</button>

            <div class="auto-refresh">
                <span>Auto-refresh:</span>
                <label class="switch">
                    <input type="checkbox" id="autoRefresh" checked onchange="toggleAutoRefresh()">
                    <span class="slider"></span>
                </label>
            </div>

            <div class="refresh-status" id="refreshStatus">
                <span>🕐</span>
                <span>Last updated: Never</span>
            </div>
        </div>

        <div class="dashboard-grid">
            <!-- System Overview -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3 class="card-title">🖥️ System Overview</h3>
                    <div class="status-indicator">
                        <div class="status-dot status-online"></div>
                        <span>Healthy</span>
                    </div>
                </div>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value uptime" id="systemUptime">99.9%</div>
                        <div class="metric-label">Uptime</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value response-time" id="avgResponseTime">45ms</div>
                        <div class="metric-label">Avg Response</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value requests" id="totalRequests">15,847</div>
                        <div class="metric-label">Total Requests</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value errors" id="errorCount">3</div>
                        <div class="metric-label">Errors</div>
                    </div>
                </div>
                <div class="system-info">
                    <div class="info-item">
                        <span>CPU Usage</span>
                        <span id="cpuUsage">23%</span>
                    </div>
                    <div class="info-item">
                        <span>Memory Usage</span>
                        <span id="memoryUsage">67%</span>
                    </div>
                    <div class="info-item">
                        <span>Active Connections</span>
                        <span id="activeConnections">42</span>
                    </div>
                    <div class="info-item">
                        <span>Disk Usage</span>
                        <span id="diskUsage">34%</span>
                    </div>
                </div>
            </div>

            <!-- Performance Metrics -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3 class="card-title">⚡ Performance Metrics</h3>
                    <div class="status-indicator">
                        <div class="status-dot status-online"></div>
                        <span>Optimal</span>
                    </div>
                </div>
                <div class="performance-chart">
                    <div class="chart-line"></div>
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;">
                        <div style="font-size: 1.2rem; font-weight: bold; color: #667eea;">Real-time Performance</div>
                        <div style="font-size: 0.9rem; color: #6c757d;">Response time trending</div>
                    </div>
                </div>
                <div class="metrics-grid" style="margin-top: 1rem;">
                    <div class="metric-item">
                        <div class="metric-value" style="color: #28a745;" id="minResponse">12ms</div>
                        <div class="metric-label">Min Response</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" style="color: #dc3545;" id="maxResponse">156ms</div>
                        <div class="metric-label">Max Response</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" style="color: #ffc107;" id="p95Response">89ms</div>
                        <div class="metric-label">95th Percentile</div>
                    </div>
                </div>
            </div>

            <!-- Server Status -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3 class="card-title">🔧 MCP Servers</h3>
                    <div class="status-indicator">
                        <div class="status-dot status-warning"></div>
                        <span>8/10 Online</span>
                    </div>
                </div>
                <div class="server-list" id="serverList">
                    <!-- Server items will be populated here -->
                </div>
            </div>

            <!-- Usage Analytics -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3 class="card-title">📈 Usage Analytics</h3>
                    <div class="status-indicator">
                        <div class="status-dot status-online"></div>
                        <span>Tracking</span>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-placeholder">
                        <div style="font-size: 1.2rem; font-weight: bold; margin-bottom: 0.5rem;">Usage Trends</div>
                        <div style="font-size: 0.9rem;">Requests per hour over the last 24 hours</div>
                        <div style="margin-top: 1rem; font-size: 2rem; color: #667eea;">📊</div>
                    </div>
                </div>
                <div class="metrics-grid" style="margin-top: 1rem;">
                    <div class="metric-item">
                        <div class="metric-value" style="color: #667eea;" id="requestsPerHour">1,247</div>
                        <div class="metric-label">Requests/Hour</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" style="color: #28a745;" id="successRate">97.8%</div>
                        <div class="metric-label">Success Rate</div>
                    </div>
                </div>
            </div>

            <!-- Alerts & Warnings -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3 class="card-title">🚨 Alerts & Warnings</h3>
                    <div class="status-indicator">
                        <div class="status-dot status-warning"></div>
                        <span>3 Active</span>
                    </div>
                </div>
                <div class="alert-list" id="alertList">
                    <!-- Alert items will be populated here -->
                </div>
            </div>

            <!-- System Logs -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3 class="card-title">📋 System Logs</h3>
                    <div class="status-indicator">
                        <div class="status-dot status-online"></div>
                        <span>Live</span>
                    </div>
                </div>
                <div class="log-container" id="logContainer">
                    <!-- Log entries will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        let autoRefreshEnabled = true;
        let refreshInterval;
        let servers = [
            { name: 'filesystem', icon: '🗂️', status: 'online', responseTime: 23, requests: 3421, errors: 0 },
            { name: 'memory', icon: '🧠', status: 'online', responseTime: 12, requests: 2876, errors: 1 },
            { name: 'time', icon: '⏰', status: 'online', responseTime: 45, requests: 1203, errors: 0 },
            { name: 'sqlite', icon: '🗄️', status: 'online', responseTime: 67, requests: 1456, errors: 0 },
            { name: 'puppeteer', icon: '🤖', status: 'warning', responseTime: 156, requests: 234, errors: 2 },
            { name: 'git', icon: '📁', status: 'online', responseTime: 34, requests: 567, errors: 0 },
            { name: 'fetch', icon: '🌐', status: 'online', responseTime: 89, requests: 2103, errors: 0 },
            { name: 'sequential-thinking', icon: '🤔', status: 'online', responseTime: 78, requests: 145, errors: 0 },
            { name: 'brave-search', icon: '🔍', status: 'offline', responseTime: 0, requests: 0, errors: 0 },
            { name: 'github', icon: '🐙', status: 'offline', responseTime: 0, requests: 0, errors: 0 }
        ];

        let alerts = [
            {
                type: 'warning',
                title: 'High Response Time',
                message: 'Puppeteer server response time exceeded 150ms threshold',
                time: new Date(Date.now() - 300000) // 5 minutes ago
            },
            {
                type: 'critical',
                title: 'Server Offline',
                message: 'Brave Search server is not responding',
                time: new Date(Date.now() - 600000) // 10 minutes ago
            },
            {
                type: 'info',
                title: 'Maintenance Window',
                message: 'Scheduled maintenance for GitHub server at 2:00 AM',
                time: new Date(Date.now() - 900000) // 15 minutes ago
            }
        ];

        // Initialize the dashboard
        document.addEventListener('DOMContentLoaded', () => {
            renderServers();
            renderAlerts();
            startLogging();
            updateMetrics();
            startAutoRefresh();
        });

        function renderServers() {
            const container = document.getElementById('serverList');
            container.innerHTML = servers.map(server => `
                <div class="server-item">
                    <div class="server-info">
                        <div class="server-icon">${server.icon}</div>
                        <div class="server-details">
                            <h4>${server.name}</h4>
                            <p>Status: ${server.status.charAt(0).toUpperCase() + server.status.slice(1)}</p>
                        </div>
                    </div>
                    <div class="server-metrics">
                        <div style="margin-bottom: 0.25rem;">
                            <span class="status-dot status-${server.status}"></span>
                            ${server.responseTime}ms
                        </div>
                        <div style="color: #6c757d;">
                            ${server.requests} requests
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderAlerts() {
            const container = document.getElementById('alertList');
            if (alerts.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #6c757d; padding: 2rem;">No active alerts</div>';
                return;
            }

            container.innerHTML = alerts.map(alert => `
                <div class="alert-item alert-${alert.type}">
                    <div class="alert-header">
                        <div class="alert-title">${alert.title}</div>
                        <div class="alert-time">${formatTimeAgo(alert.time)}</div>
                    </div>
                    <div>${alert.message}</div>
                </div>
            `).join('');
        }

        function formatTimeAgo(date) {
            const now = new Date();
            const diff = now - date;
            const minutes = Math.floor(diff / 60000);

            if (minutes < 1) return 'Just now';
            if (minutes < 60) return `${minutes}m ago`;

            const hours = Math.floor(minutes / 60);
            if (hours < 24) return `${hours}h ago`;

            const days = Math.floor(hours / 24);
            return `${days}d ago`;
        }

        function startLogging() {
            const container = document.getElementById('logContainer');

            function addLogEntry(level, message) {
                const timestamp = new Date().toLocaleTimeString();
                const logEntry = document.createElement('div');
                logEntry.className = 'log-entry';
                logEntry.innerHTML = `
                    <span class="log-timestamp">[${timestamp}]</span>
                    <span class="log-level-${level}">[${level.toUpperCase()}]</span>
                    ${message}
                `;

                container.appendChild(logEntry);
                container.scrollTop = container.scrollHeight;

                // Keep only last 50 entries
                while (container.children.length > 50) {
                    container.removeChild(container.firstChild);
                }
            }

            // Add initial log entries
            addLogEntry('info', 'MCP Monitoring Dashboard initialized');
            addLogEntry('success', 'All core servers connected successfully');
            addLogEntry('warning', 'Puppeteer server showing elevated response times');
            addLogEntry('error', 'Failed to connect to Brave Search server');

            // Simulate real-time logging
            setInterval(() => {
                const messages = [
                    { level: 'info', message: 'Health check completed for all servers' },
                    { level: 'success', message: 'Memory server cache refreshed' },
                    { level: 'info', message: 'Filesystem server processed 145 requests' },
                    { level: 'warning', message: 'High CPU usage detected on SQLite server' },
                    { level: 'success', message: 'Git server backup completed' },
                    { level: 'info', message: 'Time server synchronized with NTP' }
                ];

                const randomMessage = messages[Math.floor(Math.random() * messages.length)];
                addLogEntry(randomMessage.level, randomMessage.message);
            }, 3000 + Math.random() * 5000); // Random interval between 3-8 seconds
        }

        function updateMetrics() {
            // Simulate real-time metric updates
            const cpuUsage = Math.floor(Math.random() * 30) + 20; // 20-50%
            const memoryUsage = Math.floor(Math.random() * 40) + 50; // 50-90%
            const activeConnections = Math.floor(Math.random() * 20) + 30; // 30-50
            const diskUsage = Math.floor(Math.random() * 20) + 25; // 25-45%

            document.getElementById('cpuUsage').textContent = cpuUsage + '%';
            document.getElementById('memoryUsage').textContent = memoryUsage + '%';
            document.getElementById('activeConnections').textContent = activeConnections;
            document.getElementById('diskUsage').textContent = diskUsage + '%';

            // Update response times
            const avgResponse = Math.floor(Math.random() * 50) + 30; // 30-80ms
            const minResponse = Math.floor(Math.random() * 20) + 5; // 5-25ms
            const maxResponse = Math.floor(Math.random() * 100) + 100; // 100-200ms
            const p95Response = Math.floor(Math.random() * 60) + 60; // 60-120ms

            document.getElementById('avgResponseTime').textContent = avgResponse + 'ms';
            document.getElementById('minResponse').textContent = minResponse + 'ms';
            document.getElementById('maxResponse').textContent = maxResponse + 'ms';
            document.getElementById('p95Response').textContent = p95Response + 'ms';

            // Update request metrics
            const currentRequests = parseInt(document.getElementById('totalRequests').textContent.replace(',', ''));
            const newRequests = currentRequests + Math.floor(Math.random() * 10) + 1;
            document.getElementById('totalRequests').textContent = newRequests.toLocaleString();

            const requestsPerHour = Math.floor(Math.random() * 500) + 1000; // 1000-1500
            document.getElementById('requestsPerHour').textContent = requestsPerHour.toLocaleString();

            const successRate = (Math.random() * 5 + 95).toFixed(1); // 95.0-100.0%
            document.getElementById('successRate').textContent = successRate + '%';
        }

        function refreshAll() {
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = '🔄 Refreshing...';
            btn.disabled = true;

            setTimeout(() => {
                // Simulate data refresh
                servers.forEach(server => {
                    if (server.status === 'online') {
                        server.responseTime = Math.floor(Math.random() * 100) + 10;
                        server.requests += Math.floor(Math.random() * 50) + 1;
                    }
                });

                renderServers();
                updateMetrics();
                updateRefreshStatus();

                btn.textContent = originalText;
                btn.disabled = false;
            }, 2000);
        }

        function exportReport() {
            const report = {
                timestamp: new Date().toISOString(),
                servers: servers,
                alerts: alerts,
                metrics: {
                    uptime: document.getElementById('systemUptime').textContent,
                    avgResponseTime: document.getElementById('avgResponseTime').textContent,
                    totalRequests: document.getElementById('totalRequests').textContent,
                    errorCount: document.getElementById('errorCount').textContent,
                    cpuUsage: document.getElementById('cpuUsage').textContent,
                    memoryUsage: document.getElementById('memoryUsage').textContent
                }
            };

            const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `mcp-monitoring-report-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function clearAlerts() {
            if (confirm('Are you sure you want to clear all alerts?')) {
                alerts = [];
                renderAlerts();
            }
        }

        function emergencyStop() {
            if (confirm('This will stop all MCP servers immediately. Continue?')) {
                // Simulate emergency shutdown
                servers.forEach(server => {
                    server.status = 'offline';
                    server.responseTime = 0;
                });

                renderServers();
                alert('Emergency stop executed. All servers have been shut down.');
            }
        }

        function clearAlerts() {
            if (confirm('Are you sure you want to clear all alerts?')) {
                alerts = [];
                renderAlerts();
            }
        }

        function toggleAutoRefresh() {
            const checkbox = document.getElementById('autoRefresh');
            autoRefreshEnabled = checkbox.checked;

            if (autoRefreshEnabled) {
                startAutoRefresh();
            } else {
                clearInterval(refreshInterval);
            }
        }

        function startAutoRefresh() {
            if (autoRefreshEnabled) {
                refreshInterval = setInterval(() => {
                    updateMetrics();
                    updateRefreshStatus();
                }, 10000); // Update every 10 seconds
            }
        }

        function updateRefreshStatus() {
            const status = document.getElementById('refreshStatus');
            const now = new Date();
            status.innerHTML = `
                <span>🕐</span>
                <span>Last updated: ${now.toLocaleTimeString()}</span>
            `;
        }

        // Start periodic updates
        setInterval(() => {
            if (autoRefreshEnabled) {
                updateMetrics();
            }
        }, 5000); // Update metrics every 5 seconds

        // Update refresh status initially
        setTimeout(() => {
            updateRefreshStatus();
        }, 1000);
    </script>
</body>
</html>
